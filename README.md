# AtGorilla
## 本ツールについて
---
HaskellでAtCoderに参加する際に、サンプルのテスト等を行うツールです。
現在、入力例のテスト機能、提出機能、提出ステータス確認機能があります。
(stack newで作成したプロジェクトを前提に作成してしまいました。
 公式(?)と環境が違うと思うので、今後前提を見直し、動作を変えます。)

Haskellの勉強をかねて、自分用にゆっくり作成中です。

バグ等いっぱいあるかとおもいます。
ご使用いただけたらうれしいですが、いかなる不利益、損害が発生しても一切責任を持てません。
ご了承ください。

---
## コマンド内容

### cc

参加コンテストを指定します。
本コマンドにて、プロジェクト内に、`.atg`フォルダと`Archive`フォルダが作成されます。
現在と別のコンテストに対して作業をしたい場合、'cc'コマンドでコンテスト名を指定してください。
```
 $ ./atg cc <コンテスト名>
```
※コンテスト名: コンテストトップページのURLの最終`\`以降の文字列 (例:abc188)

### login

AtCoderに指定したユーザ名とパスワードでログインを試み、成功した場合ログイン情報を保存します。
(Cookieを保存しています。パスワードの平文はたぶん含まれていないため、保存されないと思います。)
```
$ ./atg login
username: <ユーザ名>
password: <パスワード>
```

### logout

AtCoderからログアウトし、`login`時に保存したログイン情報を削除します。
```
$ ./atg logout
```

### test

AtCoderから、指定したプログラムIDのサンプル入力例と出力例を取得し、
テストを実施します。
(`stack run`を使ってテスト実行しています。
 入力例を標準入力から与え標準出力からの出力を出力例と比較しています。
 `./app/Main.hs`ファイルにコードを記述してください。)
```
$ ./atg test <プログラムID>
running 3 tests
入力例1---------> OK
入力例2---------> OK
入力例3---------> OK
```
※プログラムID: コンテスト問題ページのURLの最終\"_\"以降の文字列 (例:a)

### testw

AtCoderから、指定したプログラムIDのサンプル入力例と出力例を取得し、
テストを実施します。
`./app/Main.hs`ファイルの変更を検知する度に、繰り返しテストを再実施します。
(ファイルの場所を変えている場合は、本機能を使わないでください。)
```
$ ./atg test <プログラムID>
running 3 tests
入力例1---------> OK
入力例2---------> OK
入力例3---------> OK
INFO-testwp-1:app/Main.hsファイルの変更確認中。変更確認されればa問題サンプルのテストを行います。
[a-z]エンターキーを押すと問題が切り替わります。
エンターキーのみを押すと終了します。
```
### submit

指定した問題の解答として、AtCoderに`./app/Main.hs`の内容を提出します。
(`data.LanguageId`には、`Haskell(GHC8.8.3)`を表す`4027`が固定値で指定されます。)
```
$ ./atg submit <プログラムID>
```
### archive
`./app/Main.hs`を、`./Archive/<コンテストID>/<プログラムID>.hs`ファイルにコピーします。
コピー先にすでにファイルがある場合は、`./Archive/<コンテストID>/<プログラムID>.bk.hs`ファイルに
バックアップをさぃ瀬尾します。
(２回め以降はバックアップファイルを上書きします。)
```
$ atg archive <プログラムID>
```
### extract
`./Archive/<コンテストID>/<プログラムID>.hs`を、`./app/Main.hs`ファイルにコピーします。
コピー先にすでにファイルがある場合は、`./atg/Main.bk.hs`ファイルに
バックアップを作成します。
(２回め以降はバックアップファイルを上書きします。)

```
$ atg extract <プログラムID>
```

---
## インストール方法
### 1.atgのビルド
githubからクローンして `stack build`でビルドしてください。
```
cd <作業フォルダ>
git clone https://github.com/kuo3/AtGorilla.git
cd atg
stack build
```
### 2.コンテスト用プロジェクトの作成
`stack new`でプロジェクトをつくって、
`package.yaml`内の`dependencies`や
`stack.yaml`内の`resolver`、`extra-deps`の設定を行ってください。
詳細は割愛いたします。また、ツールの前提を今後見直します。
```
cd <コンテスト用プロジェクト配置フォルダ>
stack new <コンテスト用プロジェクト名>
〜設定ファイルの設定〜
```
### 3.ビルドしたatgのバイナリを配置
1.でビルドした`atg`のバイナリを2.で作成したコンテスト用プロジェクトに配置してください。
(または、pathが通っている場所に`atg`のバイナリファイルを置いてください。)

---
## バージョンごとの変更点
- [ChangeLog.md](ChangeLog.md)を参照してください。
## 確認されているバグ
- 一部文字化けがある。
## TODO
- stack newで作成したプロジェクトが前提になっているので、見直して、
  公式のインストール手順に則って、テスト対象コードのビルドや、実行を指定するコードを変更する。
- スケルトンファイルをコピーする機能を追加したい。
- 各コマンドの表示を見直したい。(リッチにする。)
    - testおよびtestwコマンドのテスト失敗時の表示内容を見直し。
    - statusコマンドのテスト失敗時の表示内容を見直し。
    - 各コマンドの表示内容のうち、重要な箇所を色付けして情報を見やすくする。
      (テスト結果のAC、WAなど色で判別したい。)
- バイナリ提出機能を追加したい。
    (実現性不明。)
- インタラクティブモードを追加したい。
    (注視中のコンテスト名を表示し、提出ステータスを監視し、すべての問題に関して、一度でもAC済みか、または未ACかを表示。
     testwで作成コードを監視し、サンプルのテストを自動実行。
     コマンド追加入力で提出を実行。)
- 例外処理を全部見直す。
- パーサを全部見直す。
- テストを書く。(IOのテストどうやればいんだろうか。)
